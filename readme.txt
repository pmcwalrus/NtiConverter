1. Требования к файлу XLSX для разбора:
- Обязательно должны присутствовать листы: "Перечень", "Раскладка", "УПС", "IP", "xml_top", "xml_bot", "ВК", "add_shmems"
- Все заголовки должны быть в первой используемой строке или в объединенных с ней ячейках.
- На листе IP разделители типов устройств должны идти в первом используемом столбце и начинаться с символов "!!". Доступные типы устроств: "!!Рабочие станции", "!!Приборы сопряжения", "!!Чужие системы "
- Формат листа "Раскладка" меняться не должен. Важным элементом является "Start_address" под названием устрйоства. По нему происходит отделение одного устройства от другого.
2. Алгоритм формирования XML:
- Добавляются данные со страницы "xml_top"
- Добавляются данные со страницы "add_shmems"
- Формируется блок "nsc-pus-OAPS-write"
- Формируется блок "nsc-dev-connection"
- Формируются блоки shmem из перечня
- Формируются блоки device. При этом, после автоматического формирования параметров, добавляются данные с листа "dev_{name}", где {name} - имя устройства.
- Формируются блоки workstation
- Добавляются данные из "xml_bot".
